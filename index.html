<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="theme-color" content="#667eea" />
  <title>カップル専用アプリ v3.0</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <!-- Firebase設定画面 -->
    <div id="firebaseSetup" class="firebase-setup">
      <h2>🔧 Firebase設定</h2>
      <span class="version-tag">v3.0</span>
      <div class="setup-info">
        <strong>初回のみ設定が必要です</strong><br />
        Firebase Consoleで取得した設定情報を入力してください。
      </div>
      <input type="text" class="setup-input" id="apiKey" placeholder="API Key" value="AIzaSyAGeO5vSgT0ZUkritJHa8-Zu1vkm7KoMFw" />
      <input type="text" class="setup-input" id="authDomain" placeholder="Auth Domain" value="couple-app-b8038.firebaseapp.com" />
      <input type="text" class="setup-input" id="projectId" placeholder="Project ID" value="couple-app-b8038" />
      <input type="text" class="setup-input" id="databaseURL" placeholder="Database URL" value="https://couple-app-b8038-default-rtdb.asia-southeast1.firebasedatabase.app" />
      <input type="text" class="setup-input" id="storageBucket" placeholder="Storage Bucket" value="couple-app-b8038.firebasestorage.app" />
      <div id="saveConfigBtn" class="setup-btn">設定を保存 ✨</div>
    </div>

    <!-- 役割選択画面 -->
    <div id="roleSelect" class="role-select hidden">
      <h1>💕 ようこそ</h1>
      <span class="version-tag">v3.0</span>
      <p style="color:#666; margin-bottom:30px;">あなたの役割を選択してください</p>
      <div class="role-buttons">
        <div class="role-btn boyfriend" id="boyfriendBtn">👨 彼氏</div>
        <div class="role-btn girlfriend" id="girlfriendBtn">👩 彼女</div>
      </div>
    </div>

    <!-- メインアプリ -->
    <div id="mainApp" class="hidden">
      <!-- ヘッダー -->
      <div class="header" id="header">
        <h2 id="headerTitle"></h2>
        <div class="online-status">
          <div class="status-row">
            <div class="status-dot online"></div>
            <span>あなた</span>
          </div>
          <div class="status-row" id="partnerStatus">
            <div class="status-dot offline"></div>
            <span id="partnerStatusText">相手: オフライン</span>
          </div>
        </div>
      </div>

      <!-- メインコンテンツ -->
      <div class="main-content">
        <!-- ホーム画面 -->
        <div class="screen" id="homeScreen">
          <!-- 相手の気分・ステータス統合表示 -->
          <div class="partner-mood-display">
            <div class="partner-mood-info">
              <div class="partner-mood-emoji" id="partnerMoodEmoji">😐</div>
              <div class="partner-mood-text">
                <div class="label" id="partnerLabel">相手の気分</div>
                <div class="status normal" id="partnerMoodStatus">普通</div>
                <div class="time-label" id="partnerMoodTime">未設定</div>
              </div>
            </div>
            <div class="partner-status-info">
              <div class="partner-status-badge">
                <div class="icon" id="partnerStatusIcon">📍</div>
                <div class="text" id="partnerCurrentStatus">未設定</div>
              </div>
              <div class="partner-status-time" id="partnerStatusTime">未設定</div>
            </div>
          </div>
          <div class="typing-indicator" id="typingIndicator" aria-live="polite"></div>

          <!-- 自分の気分 -->
          <div class="mood-section">
            <div class="mood-container">
              <div class="mood-label-row">
                <div class="mood-label">✨ あなたの気分</div>
                <div class="time-label" id="myMoodTime">未設定</div>
              </div>
              <div class="mood-buttons">
                <div class="mood-btn bad" data-mood="bad">
                  😔
                  <span>あまり<br>良くない</span>
                </div>
                <div class="mood-btn normal active" data-mood="normal">
                  😐
                  <span>普通</span>
                </div>
                <div class="mood-btn good" data-mood="good">
                  😊
                  <span>嬉しい</span>
                </div>
              </div>
            </div>
          </div>

          <!-- ステータス選択 -->
          <div class="status-section">
            <div class="mood-label-row">
              <div class="status-label">📍 今のステータス</div>
              <div class="time-label" id="myStatusTime">未設定</div>
            </div>
            <div class="status-buttons" id="statusButtons">
              <div class="status-btn" data-status="🏠 家">🏠 家</div>
              <div class="status-btn" data-status="💼 仕事中">💼 仕事中</div>
              <div class="status-btn" data-status="🚶 外出中">🚶 外出中</div>
              <div class="status-btn" data-status="🛒 買い物">🛒 買い物</div>
              <div class="status-btn" data-status="🍽️ 食事中">🍽️ 食事中</div>
              <div class="status-btn" data-status="😴 休憩中">😴 休憩中</div>
            </div>
          </div>

          <!-- 共同ToDo -->
          <div class="todo-section">
            <div class="todo-header">
              <div class="todo-title">📝 ふたりのToDo</div>
              <div class="todo-sync-status" id="todoSyncStatus">オンライン</div>
            </div>
            <div class="todo-inputs">
              <input type="text" id="todoTitle" placeholder="やることを入力" />
              <input type="datetime-local" id="todoDue" />
              <button id="addTodoBtn">✨ 追加</button>
            </div>
            <ul id="todoList" class="todo-list" aria-live="polite"></ul>
          </div>
        </div>

        <!-- メッセージ画面 -->
        <div class="screen hidden" id="messageScreen">
          <div class="chat-section-full">
            <div class="chat-messages-full" id="chatMessages"></div>
            <div class="chat-input-section-full">
              <label for="imageInput" class="image-btn">📷</label>
              <input type="file" id="imageInput" accept="image/*" style="display:none" />
              <input type="text" class="chat-input" id="chatInput" placeholder="メッセージを入力..." />
              <button class="send-btn" id="sendBtn">送信</button>
            </div>
            <div class="read-tip">既読が付きます</div>
          </div>
        </div>

        <!-- 設定画面 -->
        <div class="screen hidden" id="settingsScreen">
          <div class="settings-section">
            <h3>⚙️ 設定</h3>
            
            <div class="setting-group">
              <div class="setting-label">🔔 通知設定</div>
              <label class="setting-item">
                <span>気分変更通知</span>
                <input type="checkbox" id="notifyMood" checked />
              </label>
              <label class="setting-item">
                <span>ステータス変更通知</span>
                <input type="checkbox" id="notifyStatus" checked />
              </label>
              <label class="setting-item">
                <span>メッセージ通知</span>
                <input type="checkbox" id="notifyMessage" checked />
              </label>
              <label class="setting-item">
                <span>オンライン通知</span>
                <input type="checkbox" id="notifyOnline" checked />
              </label>
            </div>

            <div class="setting-group">
              <div class="setting-label">🎨 表示設定</div>
              <label class="setting-item">
                <span>メッセージアニメーション</span>
                <input type="checkbox" id="animateMessages" checked />
              </label>
              <label class="setting-item">
                <span>既読表示</span>
                <input type="checkbox" id="showRead" checked />
              </label>
              <label class="setting-item">
                <span>入力中表示</span>
                <input type="checkbox" id="showTyping" checked />
              </label>
            </div>

            <div class="setting-group">
              <div class="setting-label">💬 メッセージ設定</div>
              <label class="setting-item">
                <span>24時間後に自動削除</span>
                <input type="checkbox" id="autoDelete" checked />
              </label>
              <label class="setting-item">
                <span>写真を自動圧縮</span>
                <input type="checkbox" id="compressImage" checked />
              </label>
            </div>

            <div class="setting-group">
              <div class="setting-label">🔐 プライバシー</div>
              <button class="setting-btn" id="clearChatBtn">チャット履歴を削除</button>
              <button class="setting-btn" id="clearTodoBtn">ToDo履歴を削除</button>
              <button class="setting-btn danger" id="resetAppBtn">アプリをリセット</button>
            </div>

            <div class="setting-group">
              <div class="setting-label">ℹ️ アプリ情報</div>
              <div class="info-item">バージョン: v3.0</div>
              <div class="info-item">役割: <span id="currentRole"></span></div>
            </div>
          </div>
        </div>
      </div>

      <!-- タブナビゲーション -->
      <div class="tab-navigation">
        <div class="tab-btn active" data-screen="homeScreen">
          <div class="tab-icon">🏠</div>
          <span>ホーム</span>
        </div>
        <div class="tab-btn" data-screen="messageScreen">
          <div class="tab-icon">💬</div>
          <span>メッセージ</span>
        </div>
        <div class="tab-btn" data-screen="settingsScreen">
          <div class="tab-icon">⚙️</div>
          <span>設定</span>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="app.js"></script>
</body>
</html>
